<!DOCTYPE HTML>
<html>
<head>
<title></title>
<link href="css/origin.css" rel="stylesheet" type="text/css" media="all">
<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" />
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<link href='//fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,900' rel='stylesheet' type='text/css'>
<script src="js/jquery.min.js"></script>
<script src="./angular.js"></script>
<script src="./ng-route.js"></script>
<link rel="stylesheet" type="text/css" href="css/magnific-popup.css">

</head>
<body>
<!-- header -->
 <div class="banner1">
		<div class="header">
		<div class="container">
			<div class="logo">
				<a href="index.html"></a>
			</div>
				<div class="hader-left">
				<h1><a href="index.html">Bakery</a></h1>
				</div>
				<div class="head-nav">
					<span class="menu"> </span>
					<ul class="cl-effect-3">
						<li class="active"><a href="index.html">Home</a></li>
						<li><a href="login.html">Login</a></li>
						<li><a href="cart.html">Cart</a></li>
						<div class="clearfix"> </div>
					</ul>
				</div>
			<div class="clearfix"> </div>
						<!-- script-for-nav -->
					<script>
						$( "span.menu" ).click(function() {
						  $( ".head-nav ul" ).slideToggle(300, function() {
							// Animation complete.
						  });
						});
					</script>
				<!-- script-for-nav --> 	
				</div>				
			</div> 
			</div>
<!-- header -->
<!---->
		<div class="container">
			<div class="specials">
				<table>
					<thead>
						<tr>
							<th>BreadName</th>
							<th>Amount</th>
							<th>Price</th>
						</tr>
					</thead>
					<tbody>

					</tbody>
				</table>
					<div class="clearfix"> </div>
				</div>
			</div>
		</div>
	<!---->

	<!-- footer -->
	<div class="footer" id="contact">
		<div class="container">
			
	</div>
<!-- footer -->
</body>
<script>
	let cartDiv = document.getElementsByClassName("specials")[0];
	let cartContainer = document.getElementsByClassName("container")[0];
	
	
	let orderPopulate = () =>{
		let h1_order = document.createElement("h1");
		h1_order.innerText = "Thank you for ordering"
		cartContainer.append(h1_order)
	}


	let cartPopulate = () => {
		// Call the Session stoage.
		Price = sessionStorage.getItem("Price");
		Bread = sessionStorage.getItem("Bread");
		Amount = sessionStorage.getItem("Amount");

		let backBtn = document.createElement("input");
		backBtn.type="button"; backBtn.value="Back to Main";

		backBtn.addEventListener('click', function(event){
			location.href='/index.html';
		})

		cartDiv.append(backBtn);

		//If there is no Item in the cart.
		if(Price === null){
			let h1= document.createElement("h1");
			h1.innerText = "There is no item in your cart!!"
			cartDiv.appendChild(h1);
		// Else there is some item in the cart.
		}else{
			realPrice = JSON.parse(Price);
			realAmount = JSON.parse(Amount)
			realBread = JSON.parse(Bread);

			let tbody = document.getElementsByTagName("tbody")[0];
			let table = document.getElementsByTagName("table")[0];
			let tPrice = 0;
			let clearBtn = document.createElement("input");
			let orderBtn = document.createElement("input");


			let Pagerouter = angular.module('orderApp', ["ngRoute"]);
			Pagerouter.config(($routeProvider)=>{
				$routeProvider
				.when('/cart',{
					templateUrl:'cart.html'
				})
				.when('/order',{
					templateUrl:'order.html'
				})
			});
			
			orderBtn.type="button"; orderBtn.value="Order";
			orderBtn.addEventListener('click', (event)=>{
				let isExecuted = confirm("Are you sure to order these breads??");
				if(isExecuted == true){
					location.href="/order.html";
				}	
			})

			//Show the Item list that user stored.
			for(let idx = 0 ; idx<realPrice.length;idx++){
				let tr = document.createElement("tr");
				let tdName = document.createElement("td");
				let tdPrice = document.createElement("td");
				let tdAmount = document.createElement("td");
				// Button for clear session Storage.
				clearBtn.type="button"; clearBtn.value="Clear Cart";
				clearBtn.addEventListener('click', function(event){
					sessionStorage.clear();
					location.reload();
				})

				

				tPrice += realPrice[idx];
				tPrice = Math.round(tPrice * 10) / 10;

				tdPrice.innerText = "$" + realPrice[idx];
				tdAmount.innerText = realAmount[idx];
				tdName.innerText = realBread[idx];
				tr.append(tdName, tdAmount, tdPrice);
				tbody.append(tr);
		
			}
			table.append("Total Price : $ " + tPrice);
			cartDiv.append(clearBtn, orderBtn);
		}

	}
	cartPopulate();

	

</script>
</html>
